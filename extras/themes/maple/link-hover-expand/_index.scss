body:not(.link-hover-expand)
  :is(a.external-link, .cm-link .cm-underline, .cm-url:not(.cm-string) .cm-underline) {
  transition: var(--animation);
  color: rgba(var(--link-external-color-rgb), var(--color-opacity));
  border-radius: var(--radius-s);
  text-underline-offset: var(--size-2-1);
  text-decoration-color: var(--link-external-color-underline);
}

body:not(.link-hover-expand)
  :is(a.external-link, .cm-link .cm-underline, .cm-url:not(.cm-string) .cm-underline):hover {
  background-color: rgba(var(--link-external-color-rgb), 0.15);
}

body:not(.link-hover-expand)
  :is(a.external-link, .cm-link .cm-underline, .cm-url:not(.cm-string) .cm-underline):active {
  background-color: rgba(var(--link-external-color-rgb), 0.35);
}

body:not(.link-hover-expand)
  :is(a.internal-link:not(.is-unresolved), .cm-hmd-internal-link > .cm-underline) {
  transition: var(--animation);
  color: rgba(var(--link-color-rgb), var(--color-opacity));
  border-radius: var(--radius-s);
  text-underline-offset: var(--size-2-1);
  text-decoration-color: var(--link-color-underline);
}

body:not(.link-hover-expand)
  :is(a.internal-link:not(.is-unresolved), .cm-hmd-internal-link > .cm-underline):hover {
  background-color: rgba(var(--link-color-rgb), 0.15);
}

body:not(.link-hover-expand)
  :is(a.internal-link:not(.is-unresolved), .cm-hmd-internal-link > .cm-underline):active {
  background-color: rgba(var(--link-color-rgb), 0.35);
}

body.link-hover-expand .cm-url {
  --link-external-decoration: none;
  --link-external-decoration-hover: none;
}

body.link-hover-expand .cm-link {
  --link-external-decoration-hover: none;
}

body.link-hover-expand .cm-hmd-internal-link > .cm-underline {
  --link-decoration-hover: none;
}

body.link-hover-expand
  :is(a.external-link:not(.is-unresolved), :is(.cm-link, .cm-url) > .cm-underline) {
  font-size: var(--link-text-size);
  box-shadow: inset 0 -0.1em 0 var(--link-external-color-underline);
  text-decoration: none !important;
  transition: var(--animation);
  color: var(--link-external-color) !important;
}

body.link-hover-expand
  :is(a.external-link:not(.is-unresolved), :is(.cm-link, .cm-url) > .cm-underline):hover,
body.link-hover-expand
  :is(a.external-link:not(.is-unresolved), :is(.cm-link, .cm-url) > .cm-underline):focus {
  box-shadow: inset 0 -1.3em 0 var(--link-external-color-underline);
  --link-color: var(--setting-link-internal-color-hover, var(--text-on-accent));
  --link-external-color: var(--setting-link-external-color-hover, var(--text-on-accent));
}

body.link-hover-expand
  :is(a.internal-link:not(.is-unresolved), .cm-hmd-internal-link > .cm-underline) {
  font-size: var(--link-text-size);
  box-shadow: inset 0 -0.1em 0 var(--link-color-underline);
  text-decoration: none !important;
  transition: var(--animation);
  color: var(--link-color) !important;
}

body.link-hover-expand
  :is(a.internal-link:not(.is-unresolved), .cm-hmd-internal-link > .cm-underline):hover,
body.link-hover-expand
  :is(a.internal-link:not(.is-unresolved), .cm-hmd-internal-link > .cm-underline):focus {
  box-shadow: inset 0 -1.3em 0 var(--link-color-underline);
  --link-color: var(--setting-link-internal-color-hover, var(--text-on-accent));
  --link-external-color: var(--setting-link-external-color-hover, var(--text-on-accent));
}

body.link-hover-expand :is(.cm-hmd-internal-link, .cm-link) {
  transition: color var(--animation);
}
